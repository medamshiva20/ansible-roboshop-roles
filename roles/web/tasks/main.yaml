- name: Install nginx package
  ansible.builtin.yum:
   name: nginx
   state: installed

- name: Start and Enable nginx 
  ansible.builtin.service:
   name: nginx
   start: started:
   enabled: true

- name: Remove html directory
  ansible.builtin.file:
   name: /usr/share/nginx/html
   state: absent

- name: Create html directory
  ansible.builtin.file:
   name: /usr/share/nginx/html
   state: directory

- name: Download web artifact
  ansible.builtin.get_url:
   url: https://roboshop-builds.s3.amazonaws.com/web.zip
   dest: /tmp

- name: Extract web artifact
  ansible.builtin.unarchive:
   src: /tmp/web.zip
   dest: /usr/share/nginx/html
   remote_src: yes

- name: copy roboshop.conf file
  ansible.builtin.template:
   src: roboshop.conf.j2
   dest: /etc/nginx/default.d/roboshop.conf
  notify: restart nginx

  